{"version":3,"file":"usePollingServices-21732ed4.js","sources":["../../../.svelte-kit/adapter-node/chunks/usePollingServices.js"],"sourcesContent":["import { o as onDestroy } from \"./ssr.js\";\nimport { w as writable } from \"./index2.js\";\nfunction usePollingServices() {\n  const state = writable({\n    services: [],\n    loading: true,\n    error: \"\",\n    isPolling: false\n  });\n  let intervalId = null;\n  let currentController = null;\n  const fetchServices = async (silent = false) => {\n    if (currentController) {\n      currentController.abort();\n    }\n    currentController = new AbortController();\n    if (!silent) {\n      state.update((s) => ({ ...s, loading: true, error: \"\" }));\n    }\n    try {\n      const response = await fetch(\"/api/services\", {\n        signal: currentController.signal\n      });\n      if (!response.ok) {\n        throw new Error(`HTTP error! status: ${response.status}`);\n      }\n      const services = await response.json();\n      state.update((s) => ({\n        ...s,\n        services,\n        loading: false,\n        error: \"\"\n      }));\n    } catch (err) {\n      if (err instanceof Error && err.name === \"AbortError\") {\n        return;\n      }\n      const errorMessage = err instanceof Error ? err.message : \"Failed to fetch services\";\n      state.update((s) => ({\n        ...s,\n        loading: false,\n        error: errorMessage\n      }));\n    }\n  };\n  const startPolling = () => {\n    if (intervalId)\n      return;\n    state.update((s) => ({ ...s, isPolling: true }));\n    intervalId = setInterval(() => {\n      fetchServices(true);\n    }, 5e3);\n  };\n  const stopPolling = () => {\n    if (intervalId) {\n      clearInterval(intervalId);\n      intervalId = null;\n    }\n    if (currentController) {\n      currentController.abort();\n      currentController = null;\n    }\n    state.update((s) => ({ ...s, isPolling: false }));\n  };\n  const refresh = () => {\n    fetchServices(false);\n  };\n  onDestroy(() => {\n    stopPolling();\n  });\n  return {\n    state,\n    refresh,\n    startPolling,\n    stopPolling\n  };\n}\nexport {\n  usePollingServices as u\n};\n"],"names":[],"mappings":"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"}