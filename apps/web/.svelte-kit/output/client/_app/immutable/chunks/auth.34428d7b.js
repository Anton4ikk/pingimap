import{w as r}from"./index.f4f048e8.js";const n=r(!1),a=r(!1),o="pingimap_admin_token";function c(){return localStorage.getItem(o)}function l(s){localStorage.setItem(o,s),n.set(!0)}function i(){localStorage.removeItem(o),n.set(!1)}async function f(s,t={}){const e=c(),u={"Content-Type":"application/json",...e&&{Authorization:`Bearer ${e}`},...t.headers};return fetch(s,{...t,headers:u})}async function p(s){a.set(!0);try{const e=await(await fetch("/api/auth/login",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({password:s})})).json();return e.success&&e.token?(l(e.token),{success:!0,message:"Login successful"}):{success:!1,message:e.message||"Login failed"}}catch(t){return console.error("Login error:",t),{success:!1,message:"Network error"}}finally{a.set(!1)}}function d(){i()}async function h(){if(!c()){n.set(!1);return}try{const e=await(await f("/api/auth/status")).json();n.set(e.authenticated||!1)}catch(t){console.error("Auth status check failed:",t),i()}}h();export{n as a,d as b,h as c,f as d,a as i,p as l};
